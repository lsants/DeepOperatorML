# DeepONet For Soil-Structure Interaction

### Description

This project aims to develop a framework for solving soil-structure interaction problems using Deep Learning. Problems of this nature usually have unbounded domains and are usually solved with the Boundary Element Method (BEM), which requires computing influence functions through costly numerical integration schemes at a significant number of points.

Traditional numerical integration techniques often struggle with such functions due to their complex nature, including singularities and improper integrals extending to infinity. By leveraging the field of operator learning and utilizing Deep Operator Networks (DeepONets), this project seeks to bypass the use of BEM and solve the differential equations directly by using data.

### Project Overview

- **Goal**: To create a PDE solver that is capable of efficiently solving soil-structure interaction problems.

- **Approach**: Employment of DeepONets with multiple training strategies.

- **Problems**: The following problems have been implemented so far:
  - Kelvin's problem (static response of an isotropic elastic 3D space to a point load).
  - Homogeneous Green functions (harmonic response of an isotropic elastic 3D space to a point load).
  
- **Implementation**: The model is developed in Python using PyTorch.

---

## Repository Structure

The repository is organized as follows:
```
ðŸ“¦ 
.gitignore
README.md
configs
config_data_generation.yaml
config_test.yaml
config_train.yaml
get_data.py
main.py
requirements.txt
run_experiments.py
src
__init__.py
exceptions.py
Â Â Â â”œâ”€Â modules
__init__.py
Â Â Â â”‚Â Â â”œâ”€Â data_generation
__init__.py
axsgrsce.dll
axsgrsce.dylib
axsgrsce.so
data_generation_base.py
data_generation_dynamic_fixed_material.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â data_generation_kelvin.py
Â Â Â â”‚Â Â â”‚Â Â â””â”€Â influence.py
Â Â Â â”‚Â Â â”œâ”€Â data_processing
__init__.py
batching.py
data_loader.py
deeponet_dataset.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â scaling.py
Â Â Â â”‚Â Â â”‚Â Â â””â”€Â transforms.py
Â Â Â â”‚Â Â â”œâ”€Â deeponet
__init__.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â components
__init__.py
base_branch.py
base_trunk.py
pod_trunk.py
pre_trained_trunk.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â trainable_branch.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â trainable_trunk.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â two_step_trunk.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â deeponet.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â factories
__init__.py
activation_factory.py
component_factory.py
loss_factory.py
model_factory.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â network_factory.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â optimizer_factory.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â strategy_factory.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â nn
__init__.py
activation_fns.py
kan.py
mlp.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â net.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â network_architectures.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â resnet.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â optimization
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â __init__.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â loss_fns.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â optimizers.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â output_handling
__init__.py
output_handling_base.py
share_branch.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â share_trunk.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â single_output.py
Â Â Â â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â split_outputs.py
Â Â Â â”‚Â Â â”‚Â Â â””â”€Â training_strategies
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â __init__.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â helpers
__init__.py
decomposition_helper.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”‚Â Â â”œâ”€Â phase_manager.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”‚Â Â â”œâ”€Â pod_helper.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”‚Â Â â””â”€Â two_step_helper.py
pod_training.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â standard_training.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â training_strategy_base.py
Â Â Â â”‚Â Â â”‚Â Â Â Â Â â””â”€Â two_step_training.py
Â Â Â â”‚Â Â â”œâ”€Â pipe
__init__.py
inference.py
optimizer_manager.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â saving.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â store_outputs.py
Â Â Â â”‚Â Â â”‚Â Â â””â”€Â training.py
Â Â Â â”‚Â Â â”œâ”€Â plotting
__init__.py
plot_axis.py
plot_basis.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â plot_field.py
Â Â Â â”‚Â Â â”‚Â Â â”œâ”€Â plot_training.py
Â Â Â â”‚Â Â â”‚Â Â â””â”€Â plot_utils.py
Â Â Â â”‚Â Â â””â”€Â utilities
__init__.py
Â Â Â â”‚Â Â Â Â Â â”œâ”€Â config_utils.py
Â Â Â â”‚Â Â Â Â Â â”œâ”€Â dir_functions.py
Â Â Â â”‚Â Â Â Â Â â””â”€Â log_functions.py
Â Â Â â”œâ”€Â test.py
Â Â Â â””â”€Â train.py
```
## Data generation

The data for training the DeepOnet can be generated by defining the boundary value problem's parameters in the  ```/configs/config_data_generation.yaml``` file and running the ```get_data.py``` script with the ```--problem``` flag with the desired problem.

## DeepONet trainning

To train or test a model, define the model and training/testing parameters in the ```/configs/config_train.yaml```/```/configs/config_test.yaml``` file and run ```main.py```.
