# Model name (actually prefix)
MODELNAME: 20241224_deeponet

# Location of .npz data file
DATAFILE: ./data/raw/displacements.npz
PRECISION: float32
DEVICE: cpu
SEED: 42

# Model location
MODEL_FOLDER: ./models/

# History location
OUTPUT_LOG_FOLDER: ./data/output/

# Plots location
IMAGES_FOLDER: ./images/

INPUT_KEYS:
  - xb
  - xt
OUTPUT_KEYS:
  - g_u_real
  - g_u_imag


# ------------------- Model architecture ------------------
TRAINING_STRATEGY: standard
OUTPUT_HANDLING: single_trunk_split_branch
N_OUTPUTS: 2
BRANCH_INPUT_SIZE: 1
TRUNK_INPUT_SIZE: 2
BASIS_FUNCTIONS: 20
BRANCH_ARCHITECTURE: resnet
BRANCH_ACTIVATION: relu
BRANCH_DEGREE: 8
BRANCH_HIDDEN_LAYERS:
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 

TRUNK_ARCHITECTURE: resnet
TRUNK_ACTIVATION: relu
TRUNK_DEGREE: 8
TRUNK_HIDDEN_LAYERS:
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 

INPUT_NORMALIZATION: true
OUTPUT_NORMALIZATION: false
TRUNK_FEATURE_EXPANSION: true
TRUNK_EXPANSION_FEATURES_NUMBER: 10

# ------------------- Parameters for vanilla training ------------------
LEARNING_RATE: 0.001
EPOCHS: 300
BATCH_SIZE: 50
TRAIN_PERC: 0.8
VAL_PERC: 0.1
TEST_PERC: 0.1
ERROR_NORM: 2
L2_REGULARIZATION: 0.00001
EARLY_STOPPING: false
LR_SCHEDULING: true
SCHEDULER_STEP_SIZE: 1000
SCHEDULER_GAMMA: 0.5
CHANGE_OPTIMIZER: true
DEFAULT_CHANGE_AT_EPOCH: 5000
PROGRESS_BAR_COLOR: 'blue'

# ------------------- Parameters for POD training ------------------
NUM_MODES: 1601 # What should be done here: create a function that determines the amount of modes for > 90% energy or look at the data in a separate script to find the good value manually, or chose desired variance (do htis later)
LEARNING_RATE: 0.001
N_EPOCHS: 1000
BATCH_SIZE: 50
TRAIN_PERC: 0.8
VAL_PERC: 0.1
TEST_PERC: 0.1
ERROR_NORM: 2
L2_REGULARIZATION: 0.000001
EARLY_STOPPING: false
LR_SCHEDULING: true
SCHEDULER_STEP_SIZE: 1000
SCHEDULER_GAMMA: 0.5
CHANGE_OPTIMIZER: true
CHANGE_AT_EPOCH: 5000
PROGRESS_BAR_COLOR: 'blue'

# ------------------- Parameters for two step training ------------------
TRUNK_TRAIN_EPOCHS: 30000
TRUNK_DECOMPOSITION: svd
TRUNK_LEARNING_RATE: 0.001
TRUNK_L2_REGULARIZATION: 0.0000001
TRUNK_EARLY_STOPPING: false
TRUNK_LR_SCHEDULING: true
TRUNK_SCHEDULER_STEP_SIZE: 2000
TRUNK_SCHEDULER_GAMMA: 0.5
TRUNK_CHANGE_OPTIMIZER: true
TRUNK_CHANGE_AT_EPOCH: 8000
TRUNK_PROGRESS_BAR_COLOR: 'magenta'

BRANCH_TRAIN_EPOCHS: 30000
BRANCH_LEARNING_RATE: 0.001
BRANCH_L2_REGULARIZATION: 0.0000001
BRANCH_EARLY_STOPPING: false
BRANCH_LR_SCHEDULING: true
BRANCH_SCHEDULER_STEP_SIZE: 2000
BRANCH_SCHEDULER_GAMMA: 0.25
BRANCH_CHANGE_OPTIMIZER: true
BRANCH_CHANGE_AT_EPOCH: 8000
BRANCH_PROGRESS_BAR_COLOR: 'cyan'