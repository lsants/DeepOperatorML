# Model name (actually prefix)
MODELNAME: 20241120_deeponet

# Location of .npz data file
DATAFILE: ./data/raw/displacements.npz # Path to input file
PRECISION: torch.float32
DEVICE: cpu
SEED: 42

# Model location
MODEL_FOLDER: ./models/

# History location
OUTPUT_LOG_FOLDER: ./data/output/ # For split indexes, normalization parameters and loss history

# Plots location
IMAGES_FOLDER: ./images/

# ------------------- Model architecture ------------------
TWO_STEP_TRAINING: false
PROPER_ORTHOGONAL_DECOMPOSITION: true
N_OUTPUTS: 2
BRANCH_INPUT_SIZE: 1
TRUNK_INPUT_SIZE: 2
TRUNK_OUTPUT_SIZE: 20
BASIS_FUNCTIONS: 20
BRANCH_ARCHITECTURE: resnet
BRANCH_MLP_ACTIVATION: relu
BRANCH_KAN_DEGREE: 8
BRANCH_HIDDEN_LAYERS:
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 

TRUNK_ARCHITECTURE: resnet
TRUNK_MLP_ACTIVATION: relu
TRUNK_KAN_DEGREE: 8
TRUNK_HIDDEN_LAYERS:
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 

INPUT_NORMALIZATION: true
OUTPUT_NORMALIZATION: true
TRUNK_FEATURE_EXPANSION: true
TRUNK_EXPANSION_FEATURES_NUMBER: 15

# ------------------- Parameters for vanilla training ------------------
LEARNING_RATE: 0.001
N_EPOCHS: 100
BATCH_SIZE: 50
TRAIN_PERC: 0.8
VAL_PERC: 0.1
TEST_PERC: 0.1
ERROR_NORM: 2
L2_REGULARIZATION: 0.000001
EARLY_STOPPING: false
LR_SCHEDULING: true
SCHEDULER_STEP_SIZE: 1000
SCHEDULER_GAMMA: 0.5
CHANGE_OPTIMIZER: true
CHANGE_AT_EPOCH: 5000

# ------------------- Parameters for POD training ------------------
LEARNING_RATE: 0.001
N_EPOCHS: 3000
BATCH_SIZE: 50
TRAIN_PERC: 0.8
VAL_PERC: 0.1
TEST_PERC: 0.1
ERROR_NORM: 2
L2_REGULARIZATION: 0.000001
EARLY_STOPPING: false
LR_SCHEDULING: true
SCHEDULER_STEP_SIZE: 1000
SCHEDULER_GAMMA: 0.5
CHANGE_OPTIMIZER: true
CHANGE_AT_EPOCH: 5000

# ------------------- Parameters for two step training ------------------
TRUNK_TRAIN_EPOCHS: 10000
TRUNK_DECOMPOSITION: SVD
TRUNK_LEARNING_RATE: 0.001
TRUNK_L2_REGULARIZATION: 0.0000001
TRUNK_EARLY_STOPPING: false
TRUNK_LR_SCHEDULING: true
TRUNK_SCHEDULER_STEP_SIZE: 1000
TRUNK_SCHEDULER_GAMMA: 0.5
TRUNK_CHANGE_OPTIMIZER: true
TRUNK_CHANGE_AT_EPOCH: 5000

BRANCH_TRAIN_EPOCHS: 5000
BRANCH_LEARNING_RATE: 0.001
BRANCH_L2_REGULARIZATION: 0.0000001
BRANCH_EARLY_STOPPING: false
BRANCH_LR_SCHEDULING: true
BRANCH_SCHEDULER_STEP_SIZE: 1000
BRANCH_SCHEDULER_GAMMA: 0.5
BRANCH_CHANGE_OPTIMIZER: true
BRANCH_CHANGE_AT_EPOCH: 3000