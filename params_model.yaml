# Parameters for training DeepONets, loaded by train_model.py.
MODELNAME: resnet_kan_deeponet_20241115_normalized_input_output_feature_expansion

# Location of .npz data file
DATAFILE: ./data/raw/displacements.npz # Path to input file
PRECISION: torch.float32
DEVICE: cpu
SEED: 42

# Model location
MODEL_FOLDER: ./models/

# History location
OUTPUT_LOG_FOLDER: ./data/output/ # For split indexes, normalization parameters and loss history

# Plots location
IMAGES_FOLDER: ./images/

# Model architecture
TWO_STEP_TRAINING: false
N_OUTPUTS: 2
BRANCH_INPUT_SIZE: 1
TRUNK_INPUT_SIZE: 2
TRUNK_OUTPUT_SIZE: 30
BASIS_FUNCTIONS: 30
BRANCH_ARCHITECTURE: resnet
BRANCH_MLP_ACTIVATION: relu
BRANCH_KAN_DEGREE: 8
BRANCH_HIDDEN_LAYERS:
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 
    - 100 

TRUNK_ARCHITECTURE: kan
TRUNK_MLP_ACTIVATION: relu
TRUNK_KAN_DEGREE: 8
TRUNK_HIDDEN_LAYERS:
    - 32 
    - 32 
    - 32 

# Training parameters
LEARNING_RATE: 0.001                   # float: learning rate used in training
N_EPOCHS: 1000                         # int: number of training epochs
BATCH_SIZE: 50                         # int: Size of batch during training
TRAIN_PERC: 0.8                         # float: the percentage of data used for training
VAL_PERC: 0.1                           # float: the percentage of training data used for validation
TEST_PERC: 0.1                           # float: the percentage of training data used for testing
ERROR_NORM: 2


L2_REGULARIZATION: 0.0000001
EARLY_STOPPING: false
LR_SCHEDULING: true
SCHEDULER_STEP_SIZE: 500
SCHEDULER_GAMMA: 0.8
CHANGE_OPTIMIZER: false
CHANGE_AT_EPOCH: 1000

INPUT_NORMALIZATION: true
OUTPUT_NORMALIZATION: true
TRUNK_FEATURE_EXPANSION: true
TRUNK_EXPANSION_FEATURES_NUMBER: 15

# ------------------- Parameters for two step training ------------------
TRUNK_DECOMPOSITION: qr
TRUNK_TRAIN_EPOCHS: 5000
TRUNK_LEARNING_RATE: 0.001
TRUNK_L2_REGULARIZATION: 0.0000001
TRUNK_EARLY_STOPPING: false
TRUNK_LR_SCHEDULING: true
TRUNK_SCHEDULER_STEP_SIZE: 500
TRUNK_SCHEDULER_GAMMA: 0.8
TRUNK_CHANGE_OPTIMIZER: false
TRUNK_CHANGE_AT_EPOCH: 1000

BRANCH_TRAIN_EPOCHS: 5000
BRANCH_LEARNING_RATE: 0.001
BRANCH_L2_REGULARIZATION: 0.0000001
BRANCH_EARLY_STOPPING: false
BRANCH_LR_SCHEDULING: false
BRANCH_SCHEDULER_STEP_SIZE: 500
BRANCH_SCHEDULER_GAMMA: 0.8
BRANCH_CHANGE_OPTIMIZER: false
BRANCH_CHANGE_AT_EPOCH: 1000